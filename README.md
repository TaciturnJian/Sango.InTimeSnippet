# 适用于 Windows Office 的客制化 LaTeX 输入窗口

程序在后台运行，当用户使用快捷键等行为将程序唤起至前台，则向windows呈现顶层窗口，并将焦点设置为顶层窗口，然后提供短语匹配和即时渲染LaTeX服务，当用户确认输入完成之后，把结果丢到粘贴板就好了。

## 要实现的功能

### 后台程序以及快捷键唤起

需要一个后台程序，能够在后台运行，并且监听快捷键（比如 Ctrl + Alt + L），当用户按下这个快捷键时，程序将前台窗口显示出来，并将焦点设置到这个窗口。

### 自定义短语匹配

要提供短语文件，允许用户自定义短语和对应的 LaTeX 代码。程序需要能够读取这个文件，并在用户输入时进行匹配。

短语文件包含了自定义短语语法，这里简单给出一个格式：

```text
# 注释

# 定义一个短语 "短语文字" -> "LaTeX代码"
"sum" -> "\sum_" 
"sumi" -> "\sum_{i=1}^n"

```

程序应该有 用户输入缓冲区 短语匹配结果缓冲区 LaTeX结果缓冲区 三个区域，用户在输入缓冲区输入内容，程序在短语匹配结果缓冲区显示匹配到的短语，用户可以通过上下键选择匹配结果，选中之后，程序将对应的 LaTeX 代码显示在 LaTeX 结果缓冲区。

应该采用贪婪匹配，匹配此次输入中最长的短语。

也就是说，如果用户输入 "sum" 渲染结果会是 "\sum_"，如果用户再输入 "i" 渲染结果会是 "\sum_{i=1}^n"。

短语中不可以包含空格，空格表示强制结束本次短语匹配。

使用 ` 符号括起来的内容表示不进行短语匹配。

让我们先开始实现这两个功能吧。

现在已经实现了快捷键，还需要实现短语匹配功能。
